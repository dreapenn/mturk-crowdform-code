<head>
<script src="https://assets.crowd.aws/crowd-html-elements.js"></script><!-- jquery -->
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1" name="viewport" />

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="nofollow" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm” crossorigin=”anonymous">
<!-- You must include this JavaScript file -->
<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>

<style>
.grid {
   max-height: 150px;
 max-width: 400px;
 width:350px;
 height:150px;
}
.container {
  position: relative;
  border: 3px solid black;
}

img.stretchy {
/*width:100px;*/
height: 150px;
}
.container1 {
width: 50%; /*Use this to control width of the parent container, hence the image*/

}
.close {
  font-size: 45px;
  font-weight: 600;
}

.msg {
    color: blue;
    font-size: 45px;
  font-weight: 600;
  text-align: center;
    
    
}


</style>
</head>

<!--------------------------------------------------------------------------------------------->
<body>
<!-- You must include crowd-form so that your task submits answers to MTurk -->
<crowd-form>
<!-- Example Section------------->
<div id="example" style='display:block' class="container">
<table>
<tr><h2>Task Instructions</h2></tr>
<tr>
   <td>
      <p>Click on the image that appears <b>scenic</b>.</p>
      <p>Use the characteristics of the images to decide which is more scenic.</p>
      <p>Scenic is defined as: "providing or relating to views of impressive or beautiful natural scenery."</p>
   <positive-example> <p>Scenic example</p>
		    <p><img width="200px" height="150px" align="center" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/examp2.jpg"/></p>
		    <p>This image is scenic.</p>
		  </positive-example></td>
    <td>
    <negative-example><p>Not scenic example</p>
		    <p><img width="200px" height="200px" align="center" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/notscenic2.jpg"/></p>
		    <p>This image is not scenic.</p>
		  </negative-example>
   </td>
</tr>
<tr><td>
<button id="show_inst" style="text-align:center;">Start task</button>
</td></tr>
</table>
</div>
<!--Training Task-------------------->    
<div id="trainingForm" style='display:none'>
    <div class="container-fluid">
        <h2>Scenicness Comparison <b>Example</b> Task</h2>
        <h3>Click on the image that appears <b>more scenic</b>.</h3>

          <!-- Target Images 2x3 grid -->

        <div class="col-sm-10 col-md-10 col-lg-10 col-xl-10">
        <div class="well well-md">
        <h3>Target Images</h3>
         <div class="row">
        <!-- (0,0) (1, 0)-->
        <table style="border-spacing: 30px; border-collapse: separate;">
        <tr>
        <td>
        <div class="container1"><img class="stretchy" id="target1" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/notscenic0.jpg" alt="Could not load target image 0,0"/>Image 1</div>
         </td>
         <td>
         <div class="container1"><img class="stretchy" id="target2" style="border: 4px dotted blue" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/examp0.jpeg" alt="Could not load target image 1,0"/>Image 2</div>
         </td>
         <td><p>Image 2 has been selected as the more scenic image. It is highlighted in blue. Although they are both natural scenes, Image 2 is more <b>impressive.</b></p></td>
       </tr>
    
      </table>
       </div>
   
                 <button type="button"  id="show_att" style="text-align:center;">Next</button>
        </div>
        
        </div>
    </div>
    
</div><!-- end training------------------------------------------->   
<!--Hard-Coded Attention Checks-------------------->
<div id="attentionForm" style='display:none'>
    <div class="container-fluid">
        <h2>Scenicness Comparison Task</h2>
        <h3>Click on the image that appears <b>more scenic</b>.</h3>

          <!-- Target Images 2x3 grid -->

        <div class="col-sm-9 col-md-9 col-lg-9 col-xl-9">
        <div class="well well-md">
        <h3>Target Images</h3>

         <div class="row">
        <!-- (0,0) (1, 0)-->
         
        <table style="border-spacing: 30px; border-collapse: separate;">
        <tr>
        <td>
            <crowd-radio-group>
        <div class="container1"><img class="stretchy" id="targetex1" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/examp1.jpg" alt="Could not load target image 0,0"/>Image 1</div>
        
         </td>
         <td>
         <div class="container1"><img class="stretchy" id="targetex2" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/notscenic1.jpeg" alt="Could not load target image 1,0"/>Image 2</div>
         </td>
       </tr>
      </table>
       </div>
                 <button type="button"  id="show_main" style="text-align:center;">Next</button>
        </div>
        </div>
    </div>
    
</div><!-- end attention check form ------------------------------------------->
<!-- Main tasks------------------>
<div id="mainForm"  style='display:none'>    
    <crowd-instructions link-text="View instructions" link-type="button">
    <short-summary>
      <p>Click on the image that appears <b>more scenic</b>.</p>
    </short-summary>
    <detailed-instructions>
      <h3>Further instructions</h3>
      <p>Click on the image that appears <b>scenic</b>.</p>
      <p>Use the characteristics of the images to decide which is more scenic.</p>
      <p>Scenic is defined as: "providing or relating to views of impressive or beautiful natural scenery."</p>
    </detailed-instructions>
    <positive-example> 
            <p>This is an example of a <b>scenic</b> image.</p>
		    <p><img width="30px" height="30px" align="center" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/examp2.jpg"/>This image is scenic because it depicts beautiful natural imagery.</p>
		  </positive-example>
		  <negative-example>
		      <p>This is an example of an image that is <b>not scenic</b></p>
		    <p><img width="30px" height="30px" align="center" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/notscenic2.jpg"/> This image is not scenic because the scenery is not impressive or beautiful.</p>
		  </negative-example>
    </crowd-instructions>

    <div class="container-fluid">
        <h2>Scenicness Comparison Task</h2>
        <h3>Click on the image that appears <b>more scenic</b>.</h3>
        <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <div class="well well-md">
        <h3>Target Images</h3>

         <div class="row">
        <!-- (0,0) (1, 0)-->
         
        <table style="border-spacing: 30px; border-collapse: separate;">
        <tr>
        <td>
        <div class="container1"><img width="400px" height="300px" id="targetOne" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/examp3.jpg" alt="Could not load target image 0,0"/>Image 1</div>
         </td>
         <td>
         <div class="container1"><img width="300px" height="300px" id="targetTwo" src="https://cis-linux2.temple.edu/~tun94111/turk/scenicex/notscenic3.jpg" alt="Could not load target image 1,0"/>Image 2</div>
         </td>
       </tr>
      </table>
      </div>
        </div>
       </div>
       </div>
    <input id="log" name="Event log" hidden></input>
    <input id="errlog" name="Error log" hidden></input>
    <input id = "oneClicked" name = "Image 1" value = "" hidden></input>
    <input id = "twoClicked" name = "Image 2"  value = "" hidden></input>
    <input id = "taskTime" name = "Time to final click" hidden></input>
    <input id = "hiddenTime" name = "Time task hidden" hidden></input>
    <input id = "attention" name = "Passed Attention Check?" hidden></input>
    <input type="hidden" id="inputAssignmentId" name="assignmentId" value="">
    <input type="hidden" id="workerId" name="workerId" value="" >
    
    <div style="text-align:center;"><crowd-button form-action="submit" id="sub">Submit My Work</crowd-button></div>

</div>

</crowd-form>

<!--------------------------------------------------------------------------------------------->
<script src="https://code.jquery.com/jquery-3.1.0.min.js"  integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="   crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js" integrity="sha384-s1ITto93iSMDxlp/79qhWHi+LsIi9Gx6yL+cOKDuymvihkfol83TYbLbOw+W/wv4" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="   crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js" integrity="sha384-s1ITto93iSMDxlp/79qhWHi+LsIi9Gx6yL+cOKDuymvihkfol83TYbLbOw+W/wv4" crossorigin="anonymous"></script>
<!--------------------------------------------------------------------------------------------->


<!-------------------Regular functions---->
<script>
function GetWorkerId() {
	var workerId = turkGetParam( 'workerId', 'NONE' );
	return workerId;
}

function turkGetParam( name, defaultValue ) {
   var regexS = "[\?&]"+name+"=([^&#]*)";
   var regex = new RegExp( regexS );
   var tmpURL = document.location.href;
   var results = regex.exec( tmpURL );
   if( results == null ) {
     return defaultValue;
   } else {
     return results[1];
   }
}

function GetAssignmentId() {
	var assignmentId = turkGetParam('assignmentId', 'NONE' );
	return assignmentId;
}	
function IsOnTurk() {
  try {
    return ((document.location.host.indexOf('mturk')!=-1) || document.forms["mturk_form"] ||
      (top != self && window.parent.location.host.indexOf("mturk") != -1));
  } catch(err) {
    // insecure content trying to access https://turk probably, so say yes:
    return true;
  }
}
document.addEventListener("DOMContentLoaded", () => {
      // variable declarations
        var startTime = new Date().getTime();
        var mainStarted = 0;
        var timeStamp = 0;
        let allLogs = "StartTime: ";
	 	    let errLogs = "";
        var oneVal = 0;
        var twoVal = 0;
        var oneEx = 0;
        var twoEx = 0;
        var timeHidden = 0;
        var timeToDecide = 0;
        var startHide = 0;
        var att = document.getElementById("attention");
                
        // Code for the buttons to click through the four sections of the task, the example, training, attention, and main forms
        document.getElementById('show_main').addEventListener('click', function(){  
            myInst= document.getElementById('attentionForm')
            myInst.style.display="none";
            myForm= document.getElementById('mainForm');
            myForm.style.display="block";
            startTime = new Date().getTime();
            mainStarted = 1;
            allLogs = allLogs.concat(JSON.stringify(startTime/1000));
            allLogs = allLogs.concat(", ");
        });
        document.getElementById('show_inst').addEventListener('click', function(){ 
            myExample= document.getElementById('example');
            myExample.style.display="none";
            myInst= document.getElementById('trainingForm');
            myInst.style.display="block";
        });
        document.getElementById('show_att').addEventListener('click', function(){    
            myExample= document.getElementById('trainingForm');
            myExample.style.display="none";
            myInst= document.getElementById('attentionForm');
            myInst.style.display="block";   
            
        });
                     
         //Start logging 
                        
        $('#assignmentId').val(GetAssignmentId());
        var curID = (IsOnTurk())? GetAssignmentId() : prompt("Doesn't look like you " +
        "are on Turk, so you're probably testing. Enter an ID to save your data with:", "id");
        var workerID=GetWorkerId();
        

        function sendData(event, timestamp){
            var dataToServer = {
                '#event': event,
                '$assignmentID': curID,
                '$workerID': workerID,
                '$timestamp': (timeStamp/1000),
                '$userAgent': navigator.userAgent,
            }
      //add data to MTurk crowdform log element  
      allLogs = allLogs.concat(" " + event + " @" + (timestamp/1000)+ ",");
      
      // Jquery POST to server
      try{
                $.post("https://cis-linux2.temple.edu/~tun94111/turk/save.php?hitId=" + String(GetAssignmentId()),
                    dataToServer
                );
                                    	
			}catch(err){
				errLogs = errLog.concat(" Jquery post failed @" + String(timeStamp/1000));
			}
        }
                        
                    
                        
    document.getElementById('targetOne').addEventListener('click', function(){
                var currTime = new Date().getTime();
                timeStamp = currTime - startTime;
                
                timeToDecide = timeStamp;
                //change selected image border to blue
                document.getElementById("targetOne").style.border = "4px dotted blue";
                oneVal = 1;
                // deselect other image if already selected
                if(twoVal != 0){
                    twoVal = 0;
                    document.getElementById("targetTwo").style.border = "0px solid black";
                    
                }
                sendData("target1 clicked", timeStamp);
                
    });
    document.getElementById('targetTwo').addEventListener('click', function(){
                var currTime = new Date().getTime();
                timeStamp = currTime - startTime;
                timeToDecide = timeStamp;
                //change selected image border to blue
                document.getElementById("targetTwo").style.border = "4px dotted blue";
                twoVal = 1;
                // deselect other image if already selected
                if(oneVal != 0){
                    oneVal = 0;
                    document.getElementById("targetOne").style.border = "0px solid black";
                    
                }
                sendData("target2 clicked", timeStamp);
    });
    
    // Attention check task images/ selection deselection JS
    document.getElementById('targetex1').addEventListener('click', function(){
                document.getElementById("targetex1").style.border = "4px dotted blue";
                oneEx = 1;
                
                if(twoEx != 0){
                    twoEx = 0;
                    document.getElementById("targetex2").style.border = "0px solid black";
                    
                }
                att.value = "true";
                
                
    });
    document.getElementById('targetex2').addEventListener('click', function(){
                document.getElementById("targetex2").style.border = "4px dotted blue";
                twoEx = 1;
                
                if(oneEx != 0){
                    oneEx = 0;
                    document.getElementById("targetex1").style.border = "0px solid black";
                    
                }
                att.value = "false";
                
    });
    
    document.addEventListener("visibilitychange", function() {
        if(mainStarted == 1){
                var currTime = new Date().getTime();
                timeStamp = currTime - startTime;
                let type = "";
                if(document.visibilityState === 'visible'){
                    type = "visibilitytovisible";
                    timeHidden += (currTime - startHide);
                }
                else{
                    type = "visibilitytohidden";
                    startHide = currTime;
                }
                sendData(type, timeStamp)
        }
    });
    document.getElementById('sub').addEventListener('click', (event) => {
                var currTime = new Date().getTime();
                timeStamp = currTime - startTime;
                
                //Put data into MTurk crowdform task answers csv
                const one = document.getElementById("oneClicked");
                const two = document.getElementById("twoClicked");
                
                if(oneVal == 1){
                    one.value = "true"
                    two.value = "false"
                }
                else if(twoVal == 1){
                    two.value = "true"
                    one.value = "false"
                }
                var time = document.getElementById("taskTime");
                const log = document.getElementById("log");
                const errLog = document.getElementById("errlog");
                var timeHid = document.getElementById("hiddenTime");
                
                log.value = allLogs;
                errLog.value = errLogs;
                time.value = timeToDecide/1000;
                timeHid.value = timeHidden/1000;
                
                
                sendData("submit clicked", timeStamp);
    });
    
    

    
});
  //end on load
</script>
    
